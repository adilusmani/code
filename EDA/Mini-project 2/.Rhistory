ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess") + geom_line()
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "lm") + geom_line()
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess") + geom_line() + geom_smooth(method = "lm",col="red")
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",ses=FALSE) + geom_line() + geom_smooth(method = "lm",col="red",se=FALSE)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE) + geom_line() + geom_smooth(method = "lm",col="red",se=FALSE)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE) + geom_line() + geom_smooth(method = "rlm",col="red",se=FALSE)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE) + geom_line() + geom_smooth(method = "lm",col="red",se=FALSE)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=1)) + geom_line() + geom_smooth(method = "lm",col="red",se=FALSE)
unemployment.series.seasonal = stl(unemployment.series,s.window = 12., degree=1)
unemployment.series.seasonal = stl(unemployment.series,s.window = 12, s.degree=1)
typeof(unemployment.series)
ts(unemployment.series)
unemployment.series.seasonal = stl(ts(unemployment.series),s.window = 12, s.degree=1)
unemployment.series.seasonal = stl(ts(unemployment.series),s.window = 1, s.degree=1)
type(ts(unemployment.series))
typeo(ts(unemployment.series))
typeof(ts(unemployment.series))
View(unemployment.series)
unemployment.series.seasonal = stl(ts(unemployment.series),s.window = 0, s.degree=1)
x = ts(unemployment.series.df$unempRate)
x
typeof(x)
stl(x,s.window = 2)
stl(x,s.window = 3)
unemployment.series.lo = lm(unempRate~period,data = unemployment.series.df)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_line()
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.75)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.15)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.20)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.30)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.5)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.4)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.10)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.15)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.16)
unemployment.series.lo2 = loess(.resid~period,data = unemployment.series.lo)
unemployment.series.lo2 = loess(.resid~period,data = unemployment.series.lo,span = 0.16)
library(broom)
install.packages('broom')
library(broom)
unemployment.series.lo.df = augment(unemployment.series.lo)
unemployment.series.lo2 = loess(.resid~period,data = unemployment.series.lo.df,span = 0.16)
unemployment.series.lo.df
unemployment.series.lo.df = augment(unemployment.series.lo)
unemployment.series.lo2 = loess(.resid~period,data = unemployment.series.lo.df,span = 0.16)
unemployment.series.lo2
unemployment.series.lo2 = lm(.resid~period,data = unemployment.series.lo.df)
unemployment.series.lo2 = loess(.resid~period,data = unemployment.series.lo.df)
is.infinite(unemployment.series.lo.df$.resid)
is.infinite(unemployment.series.lo.df$period)
unemployment.series.lo.df$.resid = numeric(unemployment.series.lo.df$.resid)
unemployment.series.lo.df$.resid = is.numeric(unemployment.series.lo.df$.resid)
unemployment.series.lo.df$period = is.numeric(unemployment.series.lo.df$period)
unemployment.series.lo2 = loess(.resid~period,data = unemployment.series.lo.df)
unemployment.series.lo2
unemployment.series.lo.df = augment(unemployment.series.lo)
unemployment.series.lo2 = loess(.resid~period,data = unemployment.series.lo.df)
View(unemployment.series.lo.df)
unemployment.series.lo = loess(unempRate~period,data = unemployment.series.df,degree = 1)
m
unemployment.series.lo = lm(unempRate~period,data = unemployment.series.df)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.16)
unemployment.series.lo.df = augment(unemployment.series.lo)
unemployment.series.lo2 = loess(.resid~period,data = unemployment.series.lo.df)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(method = "lm")
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.16)
as.numeric(unemployment.series.lo.df$.resid)
x = data.frame(.resid = as.numeric(unemployment.series.lo.df$.resid), period = as.numeric(unemployment.series.lo.df$period))
loess(x)
loess(data = x, formula = .resid~period)
unemployment.series.lo$residuals
unemployment.series.lo.df = augment(unemployment.series.lo)
unemployment.series.lo.df = data.frame(.resid = as.numeric(unemployment.series.lo.df$.resid), period = as.numeric(unemployment.series.lo.df$period))
unemployment.series.lo2 = loess(.resid~period,data = unemployment.series.lo.df)
unemployment.series.lo.df = augment(unemployment.series.lo)
unemployment.series.lo.df = data.frame(.resid1 = as.numeric(unemployment.series.lo.df$.resid), period = as.numeric(unemployment.series.lo.df$period))
unemployment.series.lo2 = loess(.resid~period,data = unemployment.series.lo.df)
ggplot(unemployment.series.lo2,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.16)
unemployment.series.lo2.df = augment(unemployment.series.lo2)
unemployment.series.lo.df = augment(unemployment.series.lo)
unemployment.series.lo.df = data.frame(.resid1 = as.numeric(unemployment.series.lo.df$.resid), period = as.numeric(unemployment.series.lo.df$period))
unemployment.series.lo2 = loess(.resid1~period,data = unemployment.series.lo.df)
unemployment.series.lo2.df = augment(unemployment.series.lo2)
ggplot(unemployment.series.lo2,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.16)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.16)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25) + geom_line()
unemployment.series.lo2 = loess(.resid1~period,data = unemployment.series.lo.df,span  =0.16)
unemployment.series.lo2.df = augment(unemployment.series.lo2)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25) + geom_line()
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25) + labs(title = "Residuals")
ggplot(ggplot(unemployment.series.lo2.df,aes(sample =  .resid))) + stat_qq()
ggplot(ggplot(unemployment.series.lo2.df,aes(sample =  .resid))) + geom_qq()
ggplot(unemployment.series.lo2.df,aes(sample =  .resid)) + stat_qq()
ggplot(unemployment.series.lo2.df,aes(sample =  .resid)) + stat_qq() + labs(title= "Normality plot")
ggplot(unemployment.series.lo2.df,aes(sample =  .resid)) + stat_qq() + labs(title= "Normality plot")ggplot(unemployment.series.lo2.df,aes(x =  .resid)) + geom_histogram() + labs(title= "Normality plot")
ggplot(unemployment.series.lo2.df,aes(x =  .resid)) + geom_histogram() + labs(title= "Normality plot")
ggplot(unemployment.series.lo2.df,aes(x =  .resid)) + geom_density() + labs(title= "Normality plot")
ggplot(unemployment.series.lo2.df,aes(sample =  .resid)) + stat_qq() + labs(title= "Normality plot")
library(tidyr)
final.df = data.frame(Period = unemployment.series.lo2.df$period,Trend = unemployment.series.lo$fitted.values - mean(unemployment.series.lo$fitted.value), Cycles = unemployment.series.lo2.df$.resid1, Residuals = unemployment.series.lo2.df$.resid)
final.df = final.df %>% gather(Type,Incidence, Trend:Residuals)
ggplot(final.df,aes(x = Period, y=Incidence)) + geom_point() + geom_line() + facet_wrap(~Type)
ggplot(final.df,aes(x = Period, y=Incidence))  + geom_line() + facet_wrap(~Type)
final.df = data.frame(Period = unemployment.series.lo2.df$period,Trend = unemployment.series.lo$fitted.values - mean(unemployment.series.lo$fitted.value), Cycles = unemployment.series.lo2$fitted, Residuals = unemployment.series.lo2.df$.resid)
final.df = final.df %>% gather(Type,Incidence, Trend:Residuals)
ggplot(final.df,aes(x = Period, y=Incidence))  + geom_line() + facet_wrap(~Type)
final.df = data.frame(Period = unemployment.series.lo.df$period,Trend = unemployment.series.lo$fitted.values - mean(unemployment.series.lo$fitted.value), Cycles = unemployment.series.lo2$fitted, Residuals = unemployment.series.lo2.df$.resid)
final.df = final.df %>% gather(Type,Incidence, Trend:Residuals)
ggplot(final.df,aes(x = Period, y=Incidence))  + geom_line() + facet_wrap(~Type)
unemployment.series.lo.df$period
final.df = data.frame(Period = unemployment.series.df$period,Trend = unemployment.series.lo$fitted.values - mean(unemployment.series.lo$fitted.value), Cycles = unemployment.series.lo2$fitted, Residuals = unemployment.series.lo2.df$.resid)
final.df = final.df %>% gather(Type,Incidence, Trend:Residuals)
ggplot(final.df,aes(x = Period, y=Incidence))  + geom_line() + facet_wrap(~Type)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=1)) + geom_line() + geom_smooth(method = "lm",col="red",se=FALSE)
unemployment.series.lo = lm(unempRate~period,data = unemployment.series.df)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.16)
final.df$Type = factor(final.df$Type,levels = c("Trend","Cycles","Residuals"))
ggplot(final.df,aes(x = Period, y=Incidence))  + geom_line() + facet_wrap(~Type)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25) + labs(title = "Residuals")
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25) + labs(title = "Residuals") + geom_line()
final.df = data.frame(Period = unemployment.series.df$period,Trend = unemployment.series.lo$fitted.values), Cycles = unemployment.series.lo2$fitted, Residuals = unemployment.series.lo2.df$.resid)
final.df = final.df %>% gather(Type,Incidence, Trend:Residuals)
final.df$Type = factor(final.df$Type,levels = c("Trend","Cycles","Residuals"))
ggplot(final.df,aes(x = Period, y=Incidence))  + geom_line() + facet_wrap(~Type)
cat("\n Variance captured Trend: ",var())
final.df = data.frame(Period = unemployment.series.df$period,Trend = unemployment.series.lo$fitted.values, Cycles = unemployment.series.lo2$fitted, Residuals = unemployment.series.lo2.df$.resid)
final.df = final.df %>% gather(Type,Incidence, Trend:Residuals)
final.df$Type = factor(final.df$Type,levels = c("Trend","Cycles","Residuals"))
ggplot(final.df,aes(x = Period, y=Incidence))  + geom_line() + facet_wrap(~Type)
cat("\n Variance captured Trend: ",var(unemployment.series.lo$fitted.values))
cat("\n Variance captured Cycles: ",var(unemployment.series.lo2$fitted.values))
cat("\n Variance captured Cycles: ",var(unemployment.series.lo2$fitted))
final.df = data.frame(Period = unemployment.series.df$period,Trend = unemployment.series.lo$fitted.values - mean(unemployment.series.lo$fitted.value), Cycles = unemployment.series.lo2$fitted, Residuals = unemployment.series.lo2.df$.resid)
final.df = final.df %>% gather(Type,Incidence, Trend:Residuals)
final.df$Type = factor(final.df$Type,levels = c("Trend","Cycles","Residuals"))
ggplot(final.df,aes(x = Period, y=Incidence))  + geom_line() + facet_wrap(~Type)
cat("\n Variance captured Trend: ",var(final.df$Incidence[final.df$Type=='Trend',])))
cat("\n Variance captured Trend: ",var(final.df$Incidence[final.df$Type=='Trend',]))
cat("\n Variance captured Trend: ",var(final.df$Incidence[final.df$Type=='Trend']))
cat("\n Vrariance in residuals: ", var(unemployment.series.lo2.df$.resid))
ggplot(unemployment.series.lo2.df,aes(sample =  .resid)) + stat_qq() + labs(title= "Normality plot")
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25) + labs(title = "Residuals") + geom_line()
mean(unemployment.series.lo2.df$.resid)
stl(unemployment.series.lo2.df$.resid)
stl(ts(unemployment.series.lo2.df$.resid))
stl(ts(unemployment.series.lo2.df$.resid),period = 30)
stl(ts(unemployment.series.lo2.df$.resid),s.window = 30)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25) + labs(title = "Residuals") + geom_line()
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=1)) + geom_line() + geom_smooth(method = "lm",col="red",se=FALSE)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.16)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.10)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.12)
unemployment.series.lo2 = loess(.resid1~period,data = unemployment.series.lo.df, span = 0.12)
unemployment.series.lo2.df = augment(unemployment.series.lo2)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.25) + labs(title = "Residuals") + geom_line()
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.20) + labs(title = "Residuals") + geom_line()
ggplot(unemployment.series.df,aes(x = period, y = unempRate)) + geom_line(size = 1) + labs(title ="Unemployment rate by month from 1948 to 2017")
ggplot(unemployment.series.df,aes(x = period, y = unempRate)) + geom_line(size = 0.1) + labs(title ="Unemployment rate by month from 1948 to 2017")
ggplot(unemployment.series.df,aes(x = period, y = unempRate)) + geom_line(size = 0.2) + labs(title ="Unemployment rate by month from 1948 to 2017")
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=1)) + geom_line(size = 0.2) + geom_smooth(method = "lm",col="red",se=FALSE)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=1)) + geom_line(size = 0.2) + geom_smooth(method = "lm",col="red",se=FALSE,size = 0.3)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=1),size = 0.3) + geom_line(size = 0.2) + geom_smooth(method = "lm",col="red",se=FALSE,size = 0.3)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12,size = 0.3)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12,size = 0.5)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12,size = 0.7)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12,size = 0.7,se=FALSE)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point() + geom_smooth(span=0.20) + labs(title = "Residuals") + geom_line(size = 0.2)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.20) + labs(title = "Residuals") + geom_line(size = 0.2)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.20,se=FALSE,size = 0.7) + labs(title = "Residuals") + geom_line(size = 0.2)
ggplot(final.df,aes(x = Period, y=Incidence))  + geom_line(size=0.7,se=FALSE) + facet_wrap(~Type)
ggplot(final.df,aes(x = Period, y=Incidence))  + geom_line(size=0.2,se=FALSE) + facet_wrap(~Type)
help(lm)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=2),size = 0.3,span = 0.2) + geom_line(size = 0.2) + geom_smooth(method = "lm",col="red",se=FALSE,size = 0.3)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=2),size = 0.3,span = 0.5) + geom_line(size = 0.5) + geom_smooth(method = "lm",col="red",se=FALSE,size = 0.3)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=2),size = 0.3,span = 0.5) + geom_line(size = 0.2) + geom_smooth(method = "lm",col="red",se=FALSE,size = 0.5)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=1),size = 0.3,span = 0.5) + geom_line(size = 0.2) + geom_smooth(method = "lm",col="red",se=FALSE,size = 0.5)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=2),size = 0.3,span = 0.5) + geom_line(size = 0.2) + geom_smooth(method = "lm",col="red",se=FALSE,size = 0.5)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=1),size = 0.3,span = 0.5) + geom_line(size = 0.2) + geom_smooth(method = "lm",col="red",se=FALSE,size = 0.5)
unemployment.series.lo = loess(unempRate~period,data = unemployment.series.df,span = 0.5)
View(unemployment.series.df)
x = data.frame(period = unemployment.series.df$period, unempRate = unemployment.series.df$unempRate)
unemployment.series.lo = loess(unempRate~period,data = x,span = 0.5)
x = data.frame(period = as.numeric(unemployment.series.df$period), unempRate = as.numeric(unemployment.series.df$unempRate))
unemployment.series.lo = loess(unempRate~period,data = x,span = 0.5)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12,size = 0.7,se=FALSE)
unemployment.series.lo = augment(loess(unempRate~period,data = x,span = 0.5))
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12,size = 0.7,se=FALSE)
final.df = data.frame(Period = unemployment.series.df$period,Trend = unemployment.series.lo$fitted.values - mean(unemployment.series.lo$fitted.value), Cycles = unemployment.series.lo2$fitted, Residuals = unemployment.series.lo2.df$.resid)
plot(dog <- stl(log(unemployment.series), "per"))
plot(dog <- stl(log(unemployment.series.df$unempRate), "per"))
unemployment.series.lo = augment(loess(unempRate~period,data = x,degree=1))
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12,size = 0.7,se=FALSE)
ggplot(x,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12,size = 0.7,se=FALSE)
unemployment.series.lo
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12,size = 0.7,se=FALSE)
plot(unemployment.series.lo$.fitted)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=1),size = 0.3) + geom_line(size = 0.2) + geom_smooth(method = "lm",col="red",se=FALSE,size = 0.5)
ggplot(unemployment.series.lo2.df,aes(sample =  .resid)) + stat_qq(size=0.2) + labs(title= "Normality plot")
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.20,se=FALSE,size = 0.7) + labs(title = "Residuals") + geom_line(size = 0.2)
ggplot(unemployment.series.lo2.df,aes(sample =  .resid)) + stat_qq(size=0.1) + labs(title= "Normality plot")
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point(size = 0.1) + geom_smooth(span=0.20,se=FALSE,size = 0.7) + labs(title = "Residuals") + geom_line(size = 0.2)
ggplot(unemployment.series.lo2.df,aes(x = period,y = .resid)) + geom_point(size = 0.1) + geom_smooth(span=0.10,se=FALSE,size = 0.7) + labs(title = "Residuals") + geom_line(size = 0.2)
unemployment.series.lo3 = loess(data = final.df,formula = as.numeric(Residuals) ~ as.numeric(Period))
final.df = data.frame(Period = unemployment.series.df$period,Trend = unemployment.series.lo$.fitted- mean(unemployment.series.lo$.fitted), Cycles = unemployment.series.lo2$fitted, Residuals = unemployment.series.lo2.df$.resid)
unemployment.series.lo3 = loess(data = final.df,formula = as.numeric(Residuals) ~ as.numeric(Period))
unemployment.series.lo3 = loess(data = final.df,formula = as.numeric(Residuals) ~ as.numeric(Period),span = 0.1)
plot(unemployment.series.lo3$residuals)
plot(unemployment.series.lo3$residuals,type='l')
x = ts(unemployment.series.lo3$residuals, start=2012)
stl(x)
stl(x,"periodc")
x = ts(unemployment.series.lo3$residuals, start=2012,frequency = 12)
stl(x,"periodc")
stl(x)
stl(x,s.window = 12)
plot(stl(x,s.window = 12)$seasonal
)
y = stl(x,s.window = 12)
plot(y$time.series)
x = ts(unemployment.series.df$unempRate, start=2012,frequency = 1)
y = stl(x,s.window = 1)
y = stl(x,s.window = 12)
x = ts(unemployment.series.df$unempRate, start=2012,frequency = 12)
y = stl(x,s.window = 12)
plot(y$time.series)
x = ts(unemployment.series.lo.df$.resid1, start=2012,frequency = 12)
plot(y$time.series)
y = stl(x,s.window = 12)
plot(y$time.series)
unemployment.series.lo = lm(unempRate~period,data = unemployment.series)
unemployment.series.lo = lm(unempRate~period,data = unemployment.series.df)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12,size = 0.7,se=FALSE)
ggplot(unemployment.series.lo,aes(x = period,y = .resid)) + geom_point(size = 0.2) + geom_smooth(span=0.12,size = 0.7,se=FALSE) + geom_line(size = 0.1)
ts(unemployment.series)
ts(unemployment.series,frequency = 12)
help(ts)
as.ts(unemployment.series,frequency = 12)
as.ts(unemployment.series)
unemployment.series
ts(unemployment.series,frequency = 12,start = 1948)
min(unemployment.series.lo.df$period)
min(unemployment.series.lo$period)
unemployment.series = read.csv('UNRATENSA.csv',header = TRUE)
unemployment.series = zoo(unemployment.series$UNRATENSA,order.by = as.Date(unemployment.series$DATE))
unemployment.series.df = data.frame(period = time(unemployment.series),unempRate = unemployment.series)
min(unemployment.series.df$period
)
strsplit(min(unemployment.series.df$period),'-')[1]
strsplit(min(unemployment.series.df$period),'-')[,1]
strsplit(min(unemployment.series.df$period),'-')
strsplit(min(unemployment.series.df$period))
strsplit(min(unemployment.series.df$period),"-")
help("strsplit")
strsplit(min(unemployment.series.df$period),"[-]")
unEmp.stl = stl(ts.series,s.window = 1,s.degree=1)
ts.series = ts(unemployment.series.lo$residuals,frequency=12,start = 1948)
unEmp.stl = stl(ts.series,s.window = 12,s.degree=1)
plot(unEmp.stl)
ggplot(unemployment.series.df,aes(x = period,y = unempRate)) + geom_smooth(method = "loess",se=FALSE,method.args = list(degree=1),size = 0.3) + geom_line(size = 0.2) + geom_smooth(method = "lm",col="red",se=FALSE,size = 0.5)
plot(unEmp.stl)
2017-1948
69/13
69/9
unemployment.series.lo.df = augment(unemployment.series.lo)
ts.series = ts(unemployment.series.lo$residuals,frequency=12,start = 1948)
unEmp.stl = stl(ts.series,s.window = 12,s.degree=1)
year.cut = cut_number(time(ts.series),n = 3)
unEmp.stl.df = data.frame(Period = time(ts.series),ts.series,year.cut)
ggplot(enEmp.stl.df,aes(x = Period,y = seasonal)) + geom_line() + facet_grid(~year.cut)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal)) + geom_line() + facet_grid(~year.cut)
ts.series
unEmp.stl.df = data.frame(Period = time(ts.series),unEmp.stl,year.cut)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal)) + geom_line() + facet_wrapr(~year.cut)
unEmp.stl.df = data.frame(Period = time(ts.series),unEmp.stl$time.series,year.cut)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal)) + geom_line() + facet_wrapr(~year.cut)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal)) + geom_line() + facet_wrap(~year.cut)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal)) + geom_line() + facet_wrap(~year.cut,ncol = 1)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales=free)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free')
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + title(labs="Seasonal plot per 23 months")
1948+23
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + title(labs="Seasonal plot per 23 months") + scale_x_continuous(labes = c("1948 - 1971"))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + title(labs="Seasonal plot per 23 months") + scale_x_continuous(labs = c("1948 - 1971"))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + title(labs="Seasonal plot per 23 months") + scale_x_continuous(breaks = c("1948 - 1971"))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_x_continuous(breaks = c("1948 - 1971"))
year.cut
1971+23
1994+23
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_x_continuous(breaks = c("1948 - 1971","1972 - 1994","1997-2017"))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_x_discrete(breaks = c("1948 - 1971","1972 - 1994","1997-2017"))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_fill_manual(breaks = c("1948 - 1971","1972 - 1994","1997-2017"))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_fill_manual(labels = c("1948 - 1971","1972 - 1994","1997-2017"))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_fill_discrete(labels = c("1948 - 1971","1972 - 1994","1997-2017"))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_fill_discrete(breaks = c("1948 - 1971","1972 - 1994","1997-2017"))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_fill_discrete(labels = c("1948 - 1971","1972 - 1994","1997-2017"))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_fill_discrete(labels = c("1948 - 1971","1972 - 1994","1997-2017"),name = "Period")
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997-2017"),name = "Period")
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period")
year.cut = cut_number(time(ts.series),n = 36)
unEmp.stl.df = data.frame(Period = time(ts.series),unEmp.stl$time.series,year.cut)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period")
nrow(unemployment.series)
nrow(unemployment.series.df)
828/12
36*3
year.cut = cut_number(time(ts.series),n = 3)
unEmp.stl.df = data.frame(Period = time(ts.series),unEmp.stl$time.series,year.cut)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period")
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period") + scale_x_continuous(breks = 1)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period") + scale_x_continuous(breaks = 1)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period") + scale_x_continuous(breaks = 23)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period") + scale_x_continuous(breaks = seq(min(Period),max(Period),1))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period")
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period") + scale_x_continuous(breaks = seq(min(unEmp.stl$Period),max(unEmp.stl$Period),1))
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 months") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period") + scale_x_continuous(breaks = seq(min(unEmp.stl.df$Period),max(unEmp.stl.df$Period),1))
monthplot(unEmp.stl,choice="seasonal")
unEmp.stl.df = data.frame(Period = time(ts.series),unEmp.stl$time.series,year.cut,month = factor(1:12))
cmo.df = data.frame(unEmp.stl.df,month = factor(1:12))
rep(1:12,23)
rep(1:12,69)
cmo.df = data.frame(unEmp.stl.df,month = c(rep(seq(1,12),69),1)))
c(rep(seq(1,12),69),1)
cmo.df = data.frame(unEmp.stl.df,month = c(rep(seq(1,12),69),1))
ggplot(cmo.df,aes(x = year,y = seasonal)) + geom_line() + facet_wrap(~factor(month))
ggplot(cmo.df,aes(x = Period,y = seasonal)) + geom_line() + facet_wrap(~factor(month))
ggplot(cmo.df,aes(x = Period,y = seasonal)) + geom_smooth(method="lm") + facet_wrap(~factor(month))
ggplot(cmo.df,aes(x = Period,y = seasonal)) + geom_smooth(method="lm",se=FALSE) + facet_wrap(~factor(month))
ggplot(cmo.df,aes(x = Period,y = seasonal)) + geom_smooth(method="lm",se=FALSE) + facet_wrap(~factor(month)) + labs(title="Monthly variation in seasonality")
x = ts(unemployment.series.df$unempRate,frequency=12,start = 1948)
y = stl(x,s.window = 12,s.degree = 1)
plot(y)
ggplot(unEmp.stl.df,aes(x = Period,y = "remainder")) + geom_line()
ggplot(unEmp.stl.df,aes(x = Period,y = remainder)) + geom_line()
ggplot(unEmp.stl.df,aes(x = Period,y = remainder)) + geom_line() + geom_smooth()
ggplot(unEmp.stl.df,aes(x = Period,y = remainder)) + geom_line(size = 0.2) + geom_smooth(size = 0.7,se=FALSE)
ggplot(unEmp.stl.df,aes(sampleremainder)) + stat_qq()
ggplot(unEmp.stl.df,aes(sample=remainder)) + stat_qq()
cat("\n Variance captured Trend: ",var(unemployment.series.lo.df$.fitted))
cat("\n Variance captured Cycles: ",var(unEmp.stl.df$trend))
cat("\n Variance captured Seasonal: ",var(unEmp.stl.df$seasonal))
cat("\n Vrariance in residuals: ", var(unEmp.stl.df$remainder))
plot(unemployment.series.lo.df$.fitted)
x = data.frame(Trend = unemployment.series.lo.df$.fitted, seasonal = unEmp.stl.df$seasonal, Period = unemployment.series.df$period)
head(x)
x = data.frame(Trend = unemployment.series.lo.df$.fitted, remainder = unEmp.stl.df$remainder+unEmp.stl.df$trend,seasonal = unEmp.stl.df$seasonal, Period = unemployment.series.df$period)
x.mode = loess(Trend+remainder~Period,data = x)
x.mode = loess(as.numeric(Trend+remainder)~as.numeric(Period),data = x)
plot(x.mode$residuals)
plot(x.mode$fitted)
plot(x$remainder)
plot(unEmp.stl.df$remainder)
final.df = data.frame(Trend = unemployment.series.lo.df$.fitted, Residual = unEmp.stl.df$remainder, Cycle = unEmp.stl.df$trend,Seasonal = unEmp.stl.df$seasonal, Period = unemployment.series.df$period)
final.df = final.df %>% gather(Type, Incidence, Trend:Seasonal)
final.df = data.frame(Trend = unemployment.series.lo.df$.fitted-mean(unemployment.series.lo.df$.fitted), Residual = unEmp.stl.df$remainder, Cycle = unEmp.stl.df$trend-mean(unEmp.stl.df$trend),Seasonal = unEmp.stl.df$seasonal, Period = unemployment.series.df$period)
final.df = final.df %>% gather(Type, Incidence, Trend:Seasonal)
ggplot(final_df,aes(x = Period, y = Incidence)) + geom_line(size = 0.3) + facet_wrap(~Type)
ggplot(final.df,aes(x = Period, y = Incidence)) + geom_line(size = 0.3) + facet_wrap(~Type)
ggplot(final.df,aes(x = Period, y = Incidence)) + geom_line(size = 0.3) + facet_wrap(~Type,ncol=1)
ggplot(final.df,aes(x = Period, y = Incidence,col=Type)) + geom_line(size = 0.3) + facet_wrap(~Type,ncol=1)
x = data.frame(Trend = unemployment.series.lo.df$.fitted, remainder = unEmp.stl.df$remainder+unEmp.stl.df$trend,seasonal = unEmp.stl.df$seasonal, Period = unemployment.series.df$period)
x.mode = loess(as.numeric(Trend+remainder)~as.numeric(Period),data = x)
ggpot(x.mode,aes(x = Period,y = .resid)) + geom_line(size = 0.2) + geom_smooth(method = "loess",span = 0.1)
ggplot(x.mode,aes(x = Period,y = .resid)) + geom_line(size = 0.2) + geom_smooth(method = "loess",span = 0.1)
ggplot(x.mode,aes(x = Period,y = residual)) + geom_line(size = 0.2) + geom_smooth(method = "loess",span = 0.1)
x.mode = augment(loess(as.numeric(Trend+remainder)~as.numeric(Period),data = x))
ggplot(x.mode,aes(x = Period,y = residual)) + geom_line(size = 0.2) + geom_smooth(method = "loess",span = 0.1)
ggplot(x.mode,aes(x = as.numeric.Period,y = residual)) + geom_line(size = 0.2) + geom_smooth(method = "loess",span = 0.1)
ggplot(x.mode,aes(x = as.numeric.Period.,y = .resid)) + geom_line(size = 0.2) + geom_smooth(method = "loess",span = 0.1)
ggplot(x.mode,aes(x = as.numeric.Period.,y = .resid)) + geom_line(size = 0.2) + geom_smooth(method = "loess",span = 0.1,se=FALSE)
cat(data.frame(Trend = var(unemployment.series.lo.df$.fitted), Cycles = var(unEmp.stl.df$trend, ), Seasonal = var(unEmp.stl.df$seasonal), Residuals = var(unEmp.stl.df$remainder)))
print(data.frame(Trend = var(unemployment.series.lo.df$.fitted), Cycles = var(unEmp.stl.df$trend, ), Seasonal = var(unEmp.stl.df$seasonal), Residuals = var(unEmp.stl.df$remainder)))
library(tidyr)
tidy(data.frame(Trend = var(unemployment.series.lo.df$.fitted), Cycles = var(unEmp.stl.df$trend, ), Seasonal = var(unEmp.stl.df$seasonal), Residuals = var(unEmp.stl.df$remainder)))
help(labs)
ggplot(x.mode,aes(x = as.numeric.Period.,y = .resid)) + geom_line(size = 0.2) + geom_smooth(method = "loess",span = 0.1,se=FALSE,size = 0.3,alpha = 0.5) + labs(title= "Assess for Cycles", xlab = "Period", ylab = "Resdiuals")
ggplot(x.mode,aes(x = as.numeric.Period.,y = .resid)) + geom_line(size = 0.2) + labs(title= "Assess for Cycles", xlab = "Period", ylab = "Resdiuals")+geom_smooth(method = "loess",span = 0.1,se=FALSE,size = 0.3,alpha = 0.5)
ggplot(x.mode,aes(x = as.numeric.Period.,y = .resid)) + geom_line(size = 0.2) + labs(title= "Assess for Cycles")+geom_smooth(method = "loess",span = 0.1,se=FALSE,size = 0.3,alpha = 0.5)
ggplot(x.mode,aes(x = as.numeric.Period.,y = .resid)) + geom_line(size = 0.2) + labs(title= "Assess for Cycles",x = "abc")+geom_smooth(method = "loess",span = 0.1,se=FALSE,size = 0.3,alpha = 0.5)
ggplot(x.mode,aes(x = unemployment.series.df$period,y = .resid)) + geom_line(size = 0.2) + labs(title= "Assess for Cycles",x = "Period",y = "Residuals")+geom_smooth(method = "loess",span = 0.1,se=FALSE,size = 0.3,alpha = 0.5)
ggplot(final.df,aes(x = Period, y = Incidence,col=Type)) + geom_line(size = 0.35) + facet_wrap(~Type,ncol=1) + labs(title = "Decomposed ")
final.df = data.frame(Trend = unemployment.series.lo.df$.fitted-mean(unemployment.series.lo.df$.fitted), Residual = unEmp.stl.df$remainder, Cycle = unEmp.stl.df$trend-mean(unEmp.stl.df$trend),Seasonal = unEmp.stl.df$seasonal, Period = unemployment.series.df$period)
final.df = final.df %>% gather(Type, Incidence, Trend:Seasonal)
ggplot(final.df,aes(x = Period, y = Incidence,col=Type)) + geom_line(size = 0.35) + facet_wrap(~Type,ncol=1) + labs(title = "Decomposed Components of Time Series")
ggplot(unEmp.stl.df,aes(x = Period,y = remainder)) + geom_line(size = 0.2) + geom_smooth(size = 0.7,se=FALSE) + labs(title = "Residual Plot")
ggplot(final.df,aes(x = Period, y = Incidence,col=Type)) + geom_line(size = 0.35,method = 'loess') + facet_wrap(~Type,ncol=1) + labs(title = "Decomposed Components of Time Series")
ggplot(final.df,aes(x = Period, y = Incidence,col=Type)) + geom_line(size = 0.35) + facet_wrap(~Type,ncol=1) + labs(title = "Decomposed Components of Time Series")
ggplot(unEmp.stl.df,aes(x = Period,y = remainder)) + geom_line(size = 0.2) + geom_smooth(size = 0.7,se=FALSE,method = "loess") + labs(title = "Residual Plot")
ggplot(unEmp.stl.df,aes(x = Period,y = as.vector(remainder))) + geom_line(size = 0.2) + geom_smooth(size = 0.7,se=FALSE,method = "loess") + labs(title = "Residual Plot")
ggplot(unEmp.stl.df,aes(x = Period,y = remainder)) + geom_line(size = 0.2) + geom_smooth(size = 0.7,se=FALSE,method = "loess") + labs(title = "Residual Plot")
unEmp.stl.df
ggplot(unEmp.stl.df,aes(x = Period,y = remainder)) + geom_line(size = 0.2) + geom_smooth(size = 0.7,se=FALSE,method = "loess") + labs(title = "Residual Plot")
ggplot(unEmp.stl.df,aes(x = unemployment.series.df$period,y = remainder)) + geom_line(size = 0.2) + geom_smooth(size = 0.7,se=FALSE,method = "loess") + labs(title = "Residual Plot")
print(data.frame(Trend = var(unemployment.series.lo.df$.fitted), Cycles = var(unEmp.stl.df$trend, ), Seasonal = var(unEmp.stl.df$seasonal), Residuals = var(unEmp.stl.df$remainder)))
ggplot(final.df,aes(x = Period, y = Incidence,col=Type)) + geom_line(size = 0.35) + facet_wrap(~factor(Type,levels = c("Trend", "Cycle", "Seasonal","Residual"),ncol=1) + labs(title = "Decomposed Components of Time Series")
)
ggplot(final.df,aes(x = Period, y = Incidence,col=Type)) + geom_line(size = 0.35) + facet_wrap(~factor(Type,levels = c("Trend", "Cycle", "Seasonal","Residual")),ncol=1) + labs(title = "Decomposed Components of Time Series")
mean( unEmp.stl.df$remainder)
setwd("~/code")
setwd("~/code/EDA/Mini-project 2")
setwd("~/Curriculum")
setwd("~/Curriculum/EDA/Mini-project 2")
df.unemp=read.csv("UNRATENSA.csv",sep = ',',header = TRUE)
colnames(df.unemp) = c("date","Unemployment")
df.newdata=ts(df.unemp$Unemployment,start=c(1948,1),freq=12)
data.df.unemp = data.frame(year=time(df.newdata), Unemployment=(df.unemp$Unemployment))
data.unemp.stl = stl(df.newdata, s.window=101, s.degree=1)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
ggplot(data.df2.unemp, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")+ggtitle("                                        Seasonality with series cut into 4 parts")+xlab("Years") + ylab("Seasonal Component")
monthplot(data.unemp.stl, choice="seasonal",main="Month Plot representing Seasonal Oscillations",xlab="Months", ylab = "Seasonal Oscillations")
help(stl)
data.unemp.stl = stl(df.newdata, s.window=101, s.degree=2)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
ggplot(data.df2.unemp, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")+ggtitle("                                        Seasonality with series cut into 4 parts")+xlab("Years") + ylab("Seasonal Component")
data.unemp.stl = stl(df.newdata, s.window=111, s.degree=2)
data.df.unemp = data.frame(year=time(df.newdata), Unemployment=(df.unemp$Unemployment))
data.unemp.stl = stl(df.newdata, s.window=111, s.degree=2)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
data.unemp.stl = stl(df.newdata, s.window=111, s.degree=1)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
ggplot(data.df2.unemp, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")+ggtitle("                                        Seasonality with series cut into 4 parts")+xlab("Years") + ylab("Seasonal Component")
data.unemp.stl = stl(df.newdata, s.window=13, s.degree=1)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
ggplot(data.df2.unemp, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")+ggtitle("                                        Seasonality with series cut into 4 parts")+xlab("Years") + ylab("Seasonal Component")
data.unemp.stl = stl(df.newdata, s.window=125, s.degree=1)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
ggplot(data.df2.unemp, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")+ggtitle("                                        Seasonality with series cut into 4 parts")+xlab("Years") + ylab("Seasonal Component")
data.unemp.stl = stl(df.newdata, s.window=91, s.degree=1)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
ggplot(data.df2.unemp, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")+ggtitle("                                        Seasonality with series cut into 4 parts")+xlab("Years") + ylab("Seasonal Component")
data.unemp.stl = stl(df.newdata, s.window=13, s.degree=1)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
ggplot(data.df2.unemp, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")+ggtitle("                                        Seasonality with series cut into 4 parts")+xlab("Years") + ylab("Seasonal Component")
help(stl)
data.unemp.stl = stl(df.newdata, s.window=201, s.degree=1)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
ggplot(data.df2.unemp, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")+ggtitle("                                        Seasonality with series cut into 4 parts")+xlab("Years") + ylab("Seasonal Component")
data.unemp.stl = stl(df.newdata, s.window=13, s.degree=1)
data.unemp.stl = stl(df.newdata, s.window=13, s.degree=1)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
ggplot(data.df2.unemp, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")+ggtitle("                                        Seasonality with series cut into 4 parts")+xlab("Years") + ylab("Seasonal Component")
data.unemp.stl = stl(df.newdata, s.window=12, s.degree=1)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
ggplot(data.df2.unemp, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")+ggtitle("                                        Seasonality with series cut into 4 parts")+xlab("Years") + ylab("Seasonal Component")
data.unemp.stl = stl(df.newdata, s.window=101, s.degree=1)
year.cut = cut_number(time(df.newdata), n=4)
data.df2.unemp = data.frame(year=time(df.newdata), data.unemp.stl$time.series, year.cut)
ggplot(data.df2.unemp, aes(x=year, y=seasonal)) + geom_line() + facet_wrap(~year.cut, ncol=1, scales="free_x")+ggtitle("                                        Seasonality with series cut into 4 parts")+xlab("Years") + ylab("Seasonal Component")
unEmp.stl = stl(ts.series,s.window = 51,s.degree=1)
year.cut = cut_number(time(ts.series),n = 3)
unEmp.stl.df = data.frame(Period = time(ts.series),unEmp.stl$time.series,year.cut)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 years") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period") + scale_x_continuous(breaks = seq(min(unEmp.stl.df$Period),max(unEmp.stl.df$Period),1))
cmo.df = data.frame(unEmp.stl.df,month = c(rep(seq(1,12),69),1))
unemployment.series = read.csv('UNRATENSA.csv',header = TRUE)
unemployment.series = zoo(unemployment.series$UNRATENSA,order.by = as.Date(unemployment.series$DATE))
unemployment.series.df = data.frame(period = time(unemployment.series),unempRate = unemployment.series)
ts.series = ts(unemployment.series.df$unempRate,frequency=12,start = 1948)
m = stl(ts.series,s.window=13,s.degree=1)
plot(m)
m = stl(ts.series,s.window=101,s.degree=1)
plot(m)
m = stl(ts.series,s.window=13,s.degree=1)
plot(m)
m = stl(ts.series,s.window=501,s.degree=1)
plot(m)
m = stl(ts.series,s.window=91,s.degree=1)
plot(m)
m = stl(ts.series,s.window=51,s.degree=1)
plot(m)
m = stl(ts.series,s.window=71,s.degree=1)
plot(m)
m = stl(ts.series,s.window=6
1,s.degree=1)
m = stl(ts.series,s.window=61,s.degree=1)
plot(m)
ggplot(unEmp.stl.df,aes(x = Period,y = seasonal,col = year.cut)) + geom_line() + facet_wrap(~year.cut,ncol = 1,scales='free') + labs(title="Seasonal plot per 23 years") + scale_colour_discrete(labels = c("1948 - 1971","1972 - 1994","1997 - 2017"),name = "Period") + scale_x_continuous(breaks = seq(min(unEmp.stl.df$Period),max(unEmp.stl.df$Period),1))
apply.weekly(unemployment.series)
apply.weekly(unemployment.series,mean)
apply.quarterly(unemployment.series,mean)
plot(apply.quarterly(unemployment.series,mean))
help("apply.daily")
unemployment.series.df[1]
unemployment.series.df[,1]
unemployment.series.df[1,]
unemployment.series.df[3:,]
unemployment.series.df[-3:,]
unemployment.series.df[:-3,]
unemployment.series.df[-3,]
head(unemployment.series.df[:-3,])
head(unemployment.series.df[:-3,])
View(unemployment.series.df[:-3,])
unemployment.series.df[:-3,]
unemployment.series.df[-3,]
(unemployment.series.df[-3,])
head(unemployment.series.df[-3,])
head(unemployment.series.df[-2,])
