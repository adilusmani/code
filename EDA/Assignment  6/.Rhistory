model = rlm(yield ~ gen+site+year+year:site,data = data,psi = psi.bisquare)
new.data = expand.grid(year = seq(1927,1936,1),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif")
model = rlm(yield ~ gen+site+year+year:site,data = data,psi = psi.bisquare)
new.data = expand.grid(year = seq(1927,1936,1),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif")
model = rlm(yield ~ gen+site+year,data = data,psi = psi.bisquare)
new.data = expand.grid(year = seq(1927,1936,1),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif")
model = rlm(yield ~ gen+site*year,data = data,psi = psi.bisquare)
new.data = expand.grid(year = seq(1927,1936,1),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif")
ggplot(data.model,aes(x = ))
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif")
View(data %>% spread(year,yield))
View(data %>% spread(yield,year))
View(data %>% spread(year,yield))
x = data
View(x %>% spread(year,yield))
x = subset(x,x$year>=1931 & x$year<=1932)
table(x$year)
View(x %>% spread(year,yield))
dummy.coef(model)
model = rlm(yield ~ gen+site*year,data = data,psi = psi.bisquare)
dummy.coef(model)
help(outer)
coefs = dummy.coef(model)
outer(coefs$year+coefs$site)
outer(coefs$year+coefs$site,"+")
outer(coefs$year,coefs$site)
outer(coefs$year,coefs$site,"+")
ggplot(data.frame(new.data,new.yield),aes(x = gen,y = new.yield,group =  site,col=site))+geom_line() + facet_wrap(~year)
model = rlm(yield ~ gen+site*year,data = data,psi = psi.bisquare)
x = dummy.coef(model)
x.df.main = outer(x$year+x$site,"+")
x.df.inner = x$`site:year`
x.df.effect = x.df.main+x.df.inner
x.df.main = outer(x$year,x$site,"+")
x.df.inner = x$`site:year`
x.df.effect = x.df.main+x.df.inner
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=2)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
years
row.names(x.df.main)
x.df.main
sites
years = rep(row.names(x.df.main),seq(1927,1936,1))
seq(1927,1936,1)
years = rep(seq(1927,1936,1),6)
sites = rep(colnames(x.df.main),each=2)
x.df.effect
x$year
x
model = rlm(yield ~ gen+year+site*year,data = data,psi = psi.bisquare)
x = dummy.coef(model)
x.df.main = outer(x$year,x$site,"+")
x
data$year = factor(data$year)
model = rlm(yield ~ gen+year+site*year,data = data,psi = psi.bisquare)
model = lm(yield ~ gen+year+site*year,data = data,psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = seq(1927,1936,1),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif")
ggplot(data.model,aes(x = ))
ggplot(data.frame(new.data,new.yield),aes(x = gen,y = new.yield,group =  site,col=site))+geom_line() + facet_wrap(~year)
x.df.main = outer(x$year,x$site,"+")
x.df.inner = x$`site:year`
x
x$year
ggplot(data.frame(new.data,new.yield),aes(x = gen,y = new.yield,group =  site,col=site))+geom_line() + facet_wrap(~year)
x.df.main = outer(x$year,x$site,"+")
x.df.inner = x$`site:year`
x.df.effect = x.df.main+x.df.inner
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=2)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
sites = rep(colnames(x.df.main),each=6)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
length(years)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
length(x.df.effect)
x.df.main = outer(x$year,x$site,"+")
x = dummy.coef(model)
x.df.main = outer(x$year,x$site,"+")
x.df.inner = x$`site:year`
x.df.main
x$year
x$site
help(outer)
model = rlm(yield ~ gen+year+site*year,data = data,psi = psi.bisquare)
ggplot(data,aes(x = yield,y = gen,group = factor(year),col=factor(year))) + geom_point() + facet_wrap(~site)
model = rlm(yield ~ gen+year+site,data = data,psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = seq(1927,1936,1),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
data = read.table('data.txt',header=TRUE)
data$year = factor(data$year)
model = rlm(yield ~ gen+year+site,data = data,psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = seq(1927,1936,1),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif")
write.csv(data,file="data.csv")
data = read.table('data.csv',header=TRUE)
data$year = factor(data$year)
data = read.table('data.csv',header=TRUE,spe=",")
data = read.table('data.csv',header=TRUE,sep=",")
data$year = factor(data$year)
ggplot(data,aes(x = year,y = yield,col=gen,group = gen))+ geom_line(alpha=0.8)+ facet_wrap(~site)
model = rlm(yield ~ gen+year+site,data = data,psi = psi.bisquare)
model = rlm(yield ~ gen+year+site+year:site,data = data,psi = psi.bisquare)
cor(data)
corresp(data)
ggplot(data,aes(x = yield,y = gen,group = factor(year),col=factor(year))) + geom_point() + facet_wrap(~site)
ggplot(data,aes(x = yield,y = gen,group = factor(year),col=factor(year))) + geom_point() + facet_wrap(~site+year)
ggplot(data.frame(new.data,new.yield),aes(x = gen,y = new.yield,group =  site,col=site))+geom_line() + facet_wrap(~year)
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  site,col=site))+geom_line() + facet_wrap(~year)
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  site,col=site))+geom_point() + facet_wrap(~year)
data = read.table('data.csv',header=TRUE,sep=",")
data$year = factor(data$year)
model = lm(yield ~ gen+year+site+year:site,data = data,psi = psi.bisquare)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  site,col=site))+geom_point() + facet_wrap(~year)
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  year,col=year))+geom_point() + facet_wrap(~site)
dummy.coef(model)
x
x = dummy.coef(model)
model = lm(yield ~ gen+year+site+year:site,data = data,psi = psi.bisquare)
x = dummy.coef(model)
x
x$year
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
model
model = augment(model)
lm
lm
model = lm(yield ~ gen+year+site+year:site,data = data,psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  year,col=year))+geom_point() + facet_wrap(~site)
x.df.main = outer(x$year,x$site,"+")
x.df.inner = x$`site:year`
x.df.effect = x.df.main+x.df.inner
x.df.main
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
length(year)
length(years)
length(sites)
length(x.df.effect)
length(x.df.inner)
x.df.inner = x$`year:site`
x.df.effect = x.df.main+x.df.inner
length(x.df.inner)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
x.s.df
ggplot(model,aes(x = gen,y = .resid,group = site,col=site))+geom_point() + facet_wrap(~year)
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
x.df.effect
x.df.effect = x.df.inner + as.vector(x.df.main)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
model = rlm(yield ~ gen+year+site+year:site,data = data,psi = psi.bisquare)
model = rlm(yield ~ gen+year+site,data = data,psi = psi.bisquare)
x = dummy.coef(model)
x.df.main = outer(x$year,x$site,"+")
x.df.inner = x$`year:site`
x.df.effect = x.df.inner + as.vector(x.df.main)
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
ggplot(model,aes(x = gen,y = .resid,group = site,col=site))+geom_point() + facet_wrap(~year)
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif")
data.model = data.model %>% gather(component,value,c(fitted,resid))
model = rlm(yield ~ gen+year+site,data = data,psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  year,col=year))+geom_point() + facet_wrap(~site)
x.df.main = outer(x$year,x$site,"+")
x.df.inner = x$`year:site`
x.df.effect = x.df.inner + as.vector(x.df.main)
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
x.df.effect = x.df.inner + as.vector(x.df.main)
x.df.effect
x.df.inner = x$`year:site`
x.df.main = outer(x$year,x$site,"+")
x.df.inner
x = dummy.coef(model)
model = rlm(yield ~ gen+year+site,data = data,psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  year,col=year))+geom_point() + facet_wrap(~site)
x.df.main = outer(x$year,x$site,"+")
x.df.inner = x$`year:site`
x.df.effect = x.df.inner + as.vector(x.df.main)
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
x
x.df.effect
x.df.main
x.df.effect = as.vector(x.df.main)
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
model = rlm(yield ~ variety+year*site,data = data,psi = psi.bisquare)
model = rlm(yield ~ gen+year*site,data = data,psi = psi.bisquare)
sum(is.na(data))
unique(data)
model = rlm(yield ~ gen+year*site,data = unique(data),psi = psi.bisquare)
dim(unique(data))
dim(data)
z = data.frame(x =c(420.5568, 693.6305, 420.5568, 946.9677, 499.1046, 946.9677))
z2 = data.frame(y=c(32, 29, 32, 27, 31, 27))
z = data.frame(x =c(420.5568, 693.6305, 420.5568, 946.9677, 499.1046, 946.9677),y=c(32, 29, 32, 27, 31, 27))
unique(data)
unique(z)
z
model = rlm(yield ~ gen+unique(year)*site,data = data,psi = psi.bisquare)
model = rlm(yield ~ gen+year*site,data = data,psi = psi.bisquare)
model = rlm(yield ~ gen+year*site,data = unique(data),psi = psi.bisquare)
data = read.table('data.csv',header=TRUE,sep=",")
data
model = rlm(yield ~ gen+year:site,data = unique(data),psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  year,col=year))+geom_point() + facet_wrap(~site)
x.df.main = outer(x$year,x$site,"+")
x.df.inner = x$`year:site`
x.df.effect = as.vector(x.df.main)
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
model = rlm(yield ~ gen+year:site+year+site,data = unique(data),psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  year,col=year))+geom_point() + facet_wrap(~site)
x.df.main = outer(x$year,x$site,"+")
x.df.inner = x$`year:site`
x.df.effect = as.vector(x.df.main)
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
x.df.effect = x.df.inner+as.vector(x.df.main)
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
model = rlm(yield ~ gen+year+site+year:site,data = unique(data),psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data = read.table('data.csv',header=TRUE,sep=",")
data$year = factor(data$year)
model = rlm(yield ~ gen+year+site+year:site,data = unique(data),psi = psi.bisquare)
model = rlm(yield ~ year+site+year:site,data = unique(data),psi = psi.bisquare)
model = rlm(yield ~ year+site+site:year,data = unique(data),psi = psi.bisquare)
model = rlm(yield ~ year+site+site*year,data = unique(data),psi = psi.bisquare)
model = rlm(yield ~ gen+year+site,data = unique(data),psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  year,col=year))+geom_point() + facet_wrap(~site)
x.df.main = outer(x$year,x$site,"+")
x.df.inner = x$`year:site`
x.df.effect = x.df.inner+as.vector(x.df.main)
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
x.df.effect = as.vector(x.df.main)
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = x.df.effect)
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
x = sapply(data,as.numeric)
x
cor(x)
x = subset(data,data$year>=1931 & data$year <= 1932)
x = subset(data,data$year==1931 & data$year == 1932)
rlm(yield ~ gen+site+year:sites)
rlm(yield ~ gen+site+year:site,data = x)
data
level(data$year)
factor(data$year)
x
x
x = subset(data,data$year==1931 & data$year == 1932)
x
data = read.table('data.csv',header=TRUE,sep=",")
x = subset(data,data$year>=1931 & data$year <= 1932)
x
dim(x)
as.list(x)
x = as.list(x)
rlm(yield ~ gen+site+year:site,data = x)
rlm(yield ~ gen+site+year:site,data = unique(x))
rlm(yield ~ gen+site+year:site,data = unique(data.frame(x)))
ggplot(model,aes(x=site,y=.resid)) + geom_boxplot()
ggplot(model,aes(x=site,y=.resid,group=year)) + geom_boxplot()
ggplot(model,aes(x=site,y=.resid)) + geom_boxplot() + facet_wrap(~year)
duplicated(x)
duplicated(data)
data[duplicated(data)]
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
model = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  year,col=year))+geom_point() + facet_wrap(~site)
unique(x)
ggplot(x.s.df,aes(x=effect,y = site, col=year)) + geom_point()
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif")
ggplot(x.s.df,aes(x=effect,y = year, col=site)) + geom_point()
ggplot(model,aes(x=site,y=.resid)) + geom_boxplot()
ggplot(model,aes(x=site,y=.year)) + geom_boxplot()
ggplot(model,aes(x=year,y=.resid)) + geom_boxplot()
mn.barley.yield <- read.table("data.csv", header=TRUE)
length(unique(mn.barley.yield$site))
length(unique(mn.barley.yield$year))
length(unique(mn.barley.yield$gen))
length(mn.barley.yield$yield)
count_by_year_gen <- count(mn.barley.yield, c("gen","year"))
count_by_year_gen <- count_by_year_gen[which(count_by_year_gen$freq > 5),] # filtering values occured in all sites. This will discard 1933 & 1928
table(mn.barley.yield$site, mn.barley.yield$year)
table(mn.barley.yield$gen, mn.barley.yield$year)
count_by_year_gen <- count(mn.barley.yield, c("gen","year"))
library(ggplot2)
library(tidyr)
library(broom)
library(MASS)
library(plyr)
count_by_year_gen <- count(mn.barley.yield, c("gen","year"))
count_by_year_gen <- count_by_year_gen[which(count_by_year_gen$freq > 5),] # filtering values occured in all sites. This will discard 1933 & 1928
table(mn.barley.yield$site, mn.barley.yield$year)
table(mn.barley.yield$gen, mn.barley.yield$year)
function (file, header = FALSE, sep = "", quote = "\"'", dec = ".",
mn.barley.yield <- read.table("data.csv", header=TRUE)
mn.barley.yield <- read.table("data.csv", header=TRUE)
length(unique(mn.barley.yield$site))
length(unique(mn.barley.yield$year))
length(unique(mn.barley.yield$gen))
length(mn.barley.yield$yield)
table(mn.barley.yield$site, mn.barley.yield$year)
table(mn.barley.yield$gen, mn.barley.yield$year)
count_by_year_gen <- count(mn.barley.yield, c("gen","year"))
count_by_year_gen <- count(mn.barley.yield, c("gen","year"))
count_by_year_gen <- count(mn.barley.yield, c("gen","year"))
ggplot(model,aes(x=1:length(.resid),y=.resid)) + geom_point()
ggplot(model,aes(x=1:length(.resid),y=.resid)) + geom_point() + geom_smooth()
ggplot(model,aes(x=site,y=yield)) + geom_line() + facet_wrap(~year)
ggplot(model,aes(x=site,y=yield)) + geom_line() + facet_wrap(~year+gen)
ggplot(model,aes(x=site,y=yield)) + geom_line() + facet_wrap(~year)
ggplot(model,aes(x=site,y=yield,col=gen)) + geom_line() + facet_wrap(~year)
ggplot(model,aes(x=gen,y=yield)) + geom_line() + facet_wrap(~year)
ggplot(model,aes(x=yield,y=gen)) + geom_line() + facet_wrap(~year)
ggplot(model,aes(x=yield,y=gen)) + geom_point() + facet_wrap(~year)
ggplot(model,aes(x=yield,y=site)) + geom_point() + facet_wrap(~year)
ggplot(model,aes(x=yield,y=site,col=site)) + geom_point() + facet_wrap(~year)
model = rlm(yield ~ gen+year+site,data = data,psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
modelX = augment(model)
new.data = expand.grid(year = (seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
modelX = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
new.data = expand.grid(year = (seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
data = read.table('data.csv',header=TRUE,sep=",")
data$year = factor(data$year)
model = rlm(yield ~ gen+year+site,data = data,psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = (seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
modelX = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = model$.fitted - mean(model$.fitted) ,resid = model$.resid)
data.model = data.frame(rows = 1:nrow(data),fitted = modelX$.fitted - mean(modelX$.fitted) ,resid = modelX$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  year,col=year))+geom_point() + facet_wrap(~site)
x.df.main = outer(x$year,x$site,"+")
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = as.vector(x.df.main))
ggplot(x.s.df,aes(x=effect,y = year, col=site)) + geom_point()
ggplot(model,aes(x=year,y=.resid)) + geom_boxplot()
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif")
ggplot(modelX,aes(x=year,y=.resid)) + geom_boxplot()
ggplot(modelX,aes(x=1:length(.resid),y=.resid)) + geom_point() + geom_smooth()
ggplot(modelX,aes(x=yield,y=site,col=site)) + geom_point() + facet_wrap(~year)
rm(list = ls())
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(MASS)
data = read.table('data.csv',header=TRUE,sep=",")
data$year = factor(data$year)
ggplot(data,aes(x = year,y = yield,col=gen,group = gen))+ geom_line(alpha=0.8)+ facet_wrap(~site)
ggplot(data,aes(x = yield,y = gen,group = factor(year),col=factor(year))) + geom_point() + facet_wrap(~site+year)
function (x, ...)
model = rlm(yield ~ gen+year+site,data = data,psi = psi.bisquare)
x = dummy.coef(model)
model = rlm(yield ~ gen+year+site,data = data,psi = psi.bisquare)
x = dummy.coef(model)
new.data = expand.grid(year = factor(seq(1927,1936,1)),gen = data.frame(table(data$gen))$Var1,site = data.frame(table(data$site))$Var1)
new.yield = predict(model,new.data)
modelX = augment(model)
data.model = data.frame(rows = 1:nrow(data),fitted = modelX$.fitted - mean(modelX$.fitted) ,resid = modelX$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  year,col=year))+geom_point() + facet_wrap(~site)
x.df.main = outer(x$year,x$site,"+")
years = rep(row.names(x.df.main),6)
sites = rep(colnames(x.df.main),each=10)
x.s.df = data.frame(year = years,site = sites,effect = as.vector(x.df.main))
ggplot(x.s.df,aes(x=effect,y = year, col=site)) + geom_point()
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif")
ggplot(modelX,aes(x=year,y=.resid)) + geom_boxplot()
ggplot(modelX,aes(x=1:length(.resid),y=.resid)) + geom_point() + geom_smooth()
ggplot(modelX,aes(x=yield,y=site,col=site)) + geom_point() + facet_wrap(~year)
library(tidyr)
modelX = data.frame(model)
data.model = data.frame(rows = 1:nrow(data),fitted = modelX$.fitted - mean(modelX$.fitted) ,resid = modelX$.resid)
ggplot(data,aes(x=yield,y=site,col=site)) + geom_point() + facet_wrap(~year)
ggplot(data,aes(x = year,y = yield,col=gen,group = gen))+ geom_line(alpha=0.8)+ facet_wrap(~site)
ggplot(data,aes(x=yield,y=site,col=site)) + geom_point() + facet_wrap(~year)+labs()
ggplot(data,aes(x=yield,y=site,col=site)) + geom_point() + facet_wrap(~year)
ggplot(data,aes(x=yield,y=site,col=site)) + geom_point() + facet_wrap(~year)+labs('Year wise yield per variety grouped by site')
ggplot(data,aes(x=yield,y=site,col=site)) + geom_point() + facet_wrap(~year)+labs(title='Year wise yield per variety grouped by site')
ggplot(data.frame(new.data,new.yield),aes(x = new.yield,y = gen,group =  year,col=year))+geom_point() + facet_wrap(~site)
ggplot(x.s.df,aes(x=effect,y = year, col=site)) + geom_point()
ggplot(x.s.df,aes(x=effect,y = year, col=site)) + geom_point() + labs(title='Effects of year over site for yield')
ggplot(x.s.df,aes(x=effect,y = year, col=site)) + geom_point() + labs(title='Effects of year over site for yield')
ggplot(x.s.df,aes(x=year,y = effect, col=site)) + geom_point() + labs(title='Effects of year over site for yield')
ggplot(modelX,aes(x=1:length(.resid),y=.resid)) + geom_point() + geom_smooth()
ggplot(modelX,aes(x=year,y=.resid)) + geom_boxplot() + labs(title='Residual Box plot per year')
ggplot(modelX,aes(x=year,y=.resid)) + geom_boxplot() + labs(title='Residual Box plot per year')+facet_wrap(~site)
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif") +labs(title='Residual-Fit Plot')
data.model = data.frame(rows = 1:nrow(data),fitted = modelX$.fitted - mean(modelX$.fitted) ,resid = modelX$.resid)
data.model = data.model %>% gather(component,value,c(fitted,resid))
ggplot(data.model,aes(sample=value)) + facet_grid(~component) + stat_qq(distribution ="qunif") +labs(title='Residual-Fit Plot')
ggplot(modelX,aes(x=1:length(.resid),y=.resid)) + geom_point() + geom_smooth(method="loess") + labs(xlab="ABC")
ggplot(modelX,aes(x=1:length(.resid),y=.resid)) + geom_point() + geom_smooth(method="loess") + labs(x="ABC")
ggplot(modelX,aes(x=1:length(.resid),y=.resid)) + geom_point() + geom_smooth(method="loess") + labs(x="Samples",y="Residuals")
